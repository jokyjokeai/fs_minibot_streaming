{
  "metadata": {
    "name": "scen_test",
    "description": "Scénario de test - Démo create_scenario v3",
    "version": "3.0",
    "theme_file": "objections_finance",
    "voice": "julie",
    "barge_in_default": true,
    "objective": "Prise de rendez-vous",
    "fallbacks": {
      "silence": "retry_silence",
      "unknown": "not_understood",
      "deny": "bye_failed"
    }
  },
  "variables": {
    "first_name": "{{first_name}}",
    "company_name": "MiniBotPanel Demo",
    "agent_name": "Julie"
  },
  "steps": {
    "hello": {
      "message_text": "Bonjour, je suis Julie de MiniBotPanel Demo. Je vous appelle pour une étude rapide. Vous avez 2 minutes?",
      "audio_file": "/usr/share/freeswitch/sounds/minibot/julie/base/hello.wav",
      "audio_type": "audio",
      "voice": "julie",
      "barge_in": true,
      "timeout": 15,
      "max_autonomous_turns": 0,
      "intent_mapping": {
        "affirm": "q1",
        "deny": "retry_hello",
        "unsure": "q1",
        "silence": "retry_silence",
        "*": "retry_hello"
      }
    },
    "retry_hello": {
      "message_text": "C'est vraiment très rapide, juste 2 minutes. Vous êtes disponible maintenant?",
      "audio_file": "/usr/share/freeswitch/sounds/minibot/julie/base/retry_hello.wav",
      "audio_type": "audio",
      "voice": "julie",
      "barge_in": true,
      "timeout": 15,
      "max_autonomous_turns": 0,
      "intent_mapping": {
        "affirm": "q1",
        "deny": "bye_failed",
        "unsure": "q1",
        "silence": "bye_failed",
        "*": "bye_failed"
      }
    },
    "retry_silence": {
      "message_text": "Allô? Vous m'entendez bien? Je peux continuer?",
      "audio_file": "/usr/share/freeswitch/sounds/minibot/julie/base/retry_silence.wav",
      "audio_type": "audio",
      "voice": "julie",
      "barge_in": true,
      "timeout": 10,
      "max_autonomous_turns": 0,
      "intent_mapping": {
        "affirm": "q1",
        "deny": "bye_failed",
        "unsure": "q1",
        "silence": "end",
        "*": "q1"
      }
    },
    "q1": {
      "message_text": "Première question : Êtes-vous propriétaire de votre logement?",
      "audio_file": "/usr/share/freeswitch/sounds/minibot/julie/base/q1.wav",
      "audio_type": "audio",
      "voice": "julie",
      "barge_in": true,
      "timeout": 15,
      "max_autonomous_turns": 0,
      "intent_mapping": {
        "affirm": "q2",
        "deny": "q2",
        "unsure": "q2",
        "silence": "retry_silence",
        "*": "bye_failed"
      }
    },
    "q2": {
      "message_text": "Deuxième question : Avez-vous plus de 55 ans?",
      "audio_file": "/usr/share/freeswitch/sounds/minibot/julie/base/q2.wav",
      "audio_type": "audio",
      "voice": "julie",
      "barge_in": true,
      "timeout": 15,
      "max_autonomous_turns": 0,
      "intent_mapping": {
        "affirm": "q3",
        "deny": "q3",
        "unsure": "q3",
        "silence": "retry_silence",
        "*": "q3"
      }
    },
    "q3": {
      "message_text": "Dernière question : Seriez-vous intéressé par des travaux de rénovation énergétique?",
      "audio_file": "/usr/share/freeswitch/sounds/minibot/julie/base/q3.wav",
      "audio_type": "audio",
      "voice": "julie",
      "barge_in": true,
      "timeout": 15,
      "max_autonomous_turns": 0,
      "intent_mapping": {
        "affirm": "is_leads",
        "deny": "is_leads",
        "unsure": "is_leads",
        "silence": "retry_silence",
        "*": "bye_failed"
      }
    },
    "is_leads": {
      "message_text": "Parfait! Je peux vous proposer un rendez-vous avec un conseiller cette semaine. Ça vous intéresse?",
      "audio_file": "/usr/share/freeswitch/sounds/minibot/julie/base/is_leads.wav",
      "audio_type": "audio",
      "voice": "julie",
      "barge_in": true,
      "timeout": 15,
      "max_autonomous_turns": 0,
      "intent_mapping": {
        "affirm": "confirm_time",
        "deny": "retry_is_leads",
        "unsure": "retry_is_leads",
        "silence": "retry_silence",
        "*": "retry_is_leads"
      }
    },
    "retry_is_leads": {
      "message_text": "C'est gratuit et sans engagement. On vous rappelle juste pour fixer les détails. Qu'en dites-vous?",
      "audio_file": "/usr/share/freeswitch/sounds/minibot/julie/base/retry_is_leads.wav",
      "audio_type": "audio",
      "voice": "julie",
      "barge_in": true,
      "timeout": 15,
      "max_autonomous_turns": 0,
      "intent_mapping": {
        "affirm": "confirm_time",
        "deny": "bye_failed",
        "unsure": "confirm_time",
        "silence": "retry_silence",
        "*": "bye_failed"
      }
    },
    "confirm_time": {
      "message_text": "Excellent! Un conseiller vous rappellera sous 48h pour planifier le rendez-vous. C'est noté!",
      "audio_file": "/usr/share/freeswitch/sounds/minibot/julie/base/confirm_time.wav",
      "audio_type": "audio",
      "voice": "julie",
      "barge_in": true,
      "timeout": 15,
      "max_autonomous_turns": 0,
      "intent_mapping": {
        "affirm": "bye",
        "deny": "bye",
        "unsure": "bye",
        "silence": "retry_silence",
        "*": "bye"
      }
    },
    "bye": {
      "message_text": "Merci beaucoup pour votre temps! À très bientôt. Bonne journée!",
      "audio_file": "/usr/share/freeswitch/sounds/minibot/julie/base/bye.wav",
      "audio_type": "audio",
      "voice": "julie",
      "barge_in": false,
      "timeout": 5,
      "is_terminal": true,
      "result": "completed",
      "actions": [
        {
          "type": "webhook",
          "config": {
            "url": "https://crm.example.com/api/leads/completed",
            "method": "POST",
            "data": {
              "source": "cold_call",
              "status": "qualified",
              "scenario": "scen_test"
            }
          }
        },
        {
          "type": "transfer",
          "config": {
            "destination": "+33612345678",
            "timeout": 30,
            "on_no_answer": "leave_voicemail"
          }
        }
      ],
      "intent_mapping": {
        "*": "end"
      }
    },
    "bye_failed": {
      "message_text": "Je comprends. Merci quand même et bonne journée!",
      "audio_file": "/usr/share/freeswitch/sounds/minibot/julie/base/bye_failed.wav",
      "audio_type": "audio",
      "voice": "julie",
      "barge_in": false,
      "timeout": 5,
      "is_terminal": true,
      "result": "failed",
      "actions": [
        {
          "type": "webhook",
          "config": {
            "url": "https://crm.example.com/api/leads/declined",
            "method": "POST",
            "data": {
              "reason": "not_interested",
              "scenario": "scen_test"
            }
          }
        }
      ],
      "intent_mapping": {
        "*": "end"
      }
    },
    "not_understood": {
      "message_text": "Désolée, je n'ai pas bien compris. Pouvez-vous répéter s'il vous plaît?",
      "audio_file": "/usr/share/freeswitch/sounds/minibot/julie/base/not_understood.wav",
      "audio_type": "audio",
      "voice": "julie",
      "barge_in": true,
      "timeout": 15,
      "intent_mapping": {
        "*": "bye_failed"
      }
    },
    "end": {
      "message_text": "",
      "audio_type": "none",
      "voice": "julie",
      "barge_in": false,
      "timeout": 0,
      "is_terminal": true,
      "result": "ended",
      "intent_mapping": {}
    }
  },
  "flow_summary": {
    "description": "Structure exacte générée par create_scenario.py v3",
    "flow": "hello → retry_hello/retry_silence → q1 → q2 → q3 → is_leads → retry_is_leads → confirm_time → bye/bye_failed → end",
    "features_v3": {
      "is_terminal": "Sur bye, bye_failed, end",
      "actions": "Webhook sur bye et bye_failed",
      "fallbacks": "Configurés dans metadata",
      "max_autonomous_turns": 0,
      "theme_file": "objections_finance"
    }
  }
}
